name: HTML Files Sync Check

# è§¦å‘æ¡ä»¶ï¼šå½“ä»£ç æ¨é€åˆ° main åˆ†æ”¯æ—¶è¿è¡Œ
on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  sync-check:
    runs-on: ubuntu-latest
    steps:
      # æ­¥éª¤ 1ï¼šæ£€å‡ºä»£ç 
      - uses: actions/checkout@v3

      # æ­¥éª¤ 2ï¼šæ£€æŸ¥ä¸¤ä¸ª HTML æ–‡ä»¶æ˜¯å¦åŒæ­¥
      - name: Check if HTML files are in sync
        run: |
          echo "Checking if intVoter.html and index.html are in sync..."
          
          # æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹
          if cmp -s intVoter.html index.html; then
            echo "âœ… SUCCESS: intVoter.html and index.html are identical"
            exit 0
          else
            echo "âŒ ERROR: intVoter.html and index.html are different"
            echo "Please run 'node sync-html.js' to sync the files before pushing"
            echo "Differences:"
            diff intVoter.html index.html
            exit 1
          fi

      # æ­¥éª¤ 3ï¼šéªŒè¯æ–‡ä»¶å­˜åœ¨æ€§
      - name: Verify files exist
        run: |
          echo "Verifying files exist..."
          if [ -f "intVoter.html" ]; then
            echo "âœ… intVoter.html exists"
          else
            echo "âŒ intVoter.html missing"
            exit 1
          fi
          
          if [ -f "index.html" ]; then
            echo "âœ… index.html exists"
          else
            echo "âŒ index.html missing"
            exit 1
          fi

      # æ­¥éª¤ 4ï¼šéªŒè¯åŒæ­¥è„šæœ¬å­˜åœ¨æ€§
      - name: Verify sync script exists
        run: |
          echo "Verifying sync script exists..."
          if [ -f "sync-html.js" ]; then
            echo "âœ… sync-html.js exists"
          else
            echo "âŒ sync-html.js missing"
            echo "Please create sync-html.js script"
            exit 1
          fi

      # æ­¥éª¤ 5ï¼šæ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
      - name: Display success message
        if: success()
        run: |
          echo "ğŸ‰ All checks passed!"
          echo "HTML files are in sync and ready for deployment"
          echo "GitHub Pages should display the latest changes correctly"